.PHONY: clean uninstall install

CC = gcc
CXX = g++

CFLAGS = -Wall -c
CXXFLAGS = -Wall -c

PREFIX = /usr/local


# for non developers, do not touch this
CFLAGS += -D UHEXE_VERSION="0.0.1" -c --std=c99
CXXFLAGS += `fox-config --cflags` -c --std=c++98 -fpic
LDFLAGS += `fox-config --libs | sed 's/-lGLU//g' | sed 's/-lGL//g' `

OUTPUT = libctl32.so
VERSION = 0.0.1

#COBJECTS = $(CSOURCES:.c=.o)

CXXSOURCES = comctl32.cpp
CXXOBJECTS = $(CXXSOURCES:.cpp=.o)


OBJECTS = $(CXXOBJECTS) $(COBJECTS)

all: $(OUTPUT)

# link executable
$(OUTPUT): $(OBJECTS)
	$(CXX) $(OBJECTS) -shared -o $@ $(LDFLAGS)

clean:
	rm -f $(OBJECTS) $(OUTPUT)

install: all
	mkdir -p $(PREFIX)/include/ice2k
	cp comctl32.h $(PREFIX)/include/ice2k/comctl32.h
	cp $(OUTPUT) $(PREFIX)/lib/$(OUTPUT)

uninstall:
	rm $(PREFIX)/include/ice2k/comctl32.h
	rmdir $(PREFIX)/include/ice2k >/dev/null 2>&1 || true
	rm -f $(PREFIX)/lib/$(OUTPUT)

